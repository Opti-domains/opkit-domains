import { Skeleton } from "antd";
import { useEffect, useState } from "react";
import { SocialProfileSimple } from "src/utils/social-oracle";
import { SocialConfig, getSocialConfig } from "src/utils/social-oracle-config";

interface DomainSocialRecordProps extends SocialConfig {
  provider: string;
  identity?: string;
  displayName?: string;
}

export function RecordSocialDomain(props: DomainSocialRecordProps) {
  // console.log(props);
  return (
    <div className="flex items-center justify-between">
      <div
        className={
          "mr-2 flex-shrink-0 flex gap-3 " +
          (!props.displayName && !props.identity ? "opacity-50" : "")
        }
      >
        <div className="h-6 rounded-full">
          {props.name === "Twitter" ? (
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M7.54752 21.7512C16.6042 21.7512 21.5578 14.2479 21.5578 7.74101C21.5578 7.52789 21.5578 7.31573 21.5434 7.10453C22.507 6.40748 23.3389 5.54441 24 4.55573C23.1014 4.95413 22.148 5.21528 21.1718 5.33045C22.1998 4.71514 22.9692 3.74723 23.3366 2.60693C22.3701 3.18054 21.3126 3.58475 20.2099 3.80213C19.4675 3.01271 18.4856 2.48997 17.4162 2.31481C16.3468 2.13966 15.2494 2.32184 14.294 2.83318C13.3385 3.34452 12.5782 4.1565 12.1307 5.14348C11.6833 6.13045 11.5735 7.23739 11.8186 8.29301C9.8609 8.19481 7.94576 7.68604 6.19745 6.79973C4.44915 5.91343 2.90676 4.66939 1.6704 3.14837C1.04073 4.23236 0.847872 5.5156 1.1311 6.73679C1.41433 7.95798 2.15234 9.02532 3.19488 9.72149C2.41123 9.69853 1.64465 9.48712 0.96 9.10517V9.16757C0.960311 10.3044 1.35385 11.4062 2.07387 12.2859C2.79389 13.1657 3.79606 13.7693 4.9104 13.9944C4.18548 14.1922 3.42487 14.2211 2.68704 14.0789C3.00181 15.0573 3.61443 15.9128 4.43924 16.5259C5.26405 17.139 6.25983 17.479 7.28736 17.4985C6.26644 18.3009 5.09731 18.8942 3.84687 19.2444C2.59643 19.5947 1.28921 19.6949 0 19.5394C2.25183 20.9844 4.87192 21.7509 7.54752 21.7474"
                fill="#1DA1F2"
              />
            </svg>
          ) : props.name === "Discord" ? (
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="22"
              height="24"
              viewBox="0 0 22 24"
              fill="none"
            >
              <path
                d="M8.88806 10.0684C8.20406 10.0684 7.66406 10.6684 7.66406 11.4004C7.66406 12.1324 8.21606 12.7324 8.88806 12.7324C9.57206 12.7324 10.1121 12.1324 10.1121 11.4004C10.1241 10.6684 9.57206 10.0684 8.88806 10.0684ZM13.2681 10.0684C12.5841 10.0684 12.0441 10.6684 12.0441 11.4004C12.0441 12.1324 12.5961 12.7324 13.2681 12.7324C13.9521 12.7324 14.4921 12.1324 14.4921 11.4004C14.4921 10.6684 13.9521 10.0684 13.2681 10.0684Z"
                fill="#7289DA"
              />
              <path
                d="M19.1005 0H3.02055C1.66455 0 0.560547 1.104 0.560547 2.472V18.696C0.560547 20.064 1.66455 21.168 3.02055 21.168H16.6285L15.9925 18.948L17.5285 20.376L18.9805 21.72L21.5605 24V2.472C21.5605 1.104 20.4565 0 19.1005 0ZM14.4685 15.672C14.4685 15.672 14.0365 15.156 13.6765 14.7C15.2485 14.256 15.8485 13.272 15.8485 13.272C15.3565 13.596 14.8885 13.824 14.4685 13.98C13.8685 14.232 13.2925 14.4 12.7285 14.496C11.5765 14.712 10.5205 14.652 9.62055 14.484C8.93655 14.352 8.34855 14.16 7.85655 13.968C7.58055 13.86 7.28055 13.728 6.98055 13.56C6.94455 13.536 6.90855 13.524 6.87255 13.5C6.84855 13.488 6.83655 13.476 6.82455 13.464C6.60855 13.344 6.48855 13.26 6.48855 13.26C6.48855 13.26 7.06455 14.22 8.58855 14.676C8.22855 15.132 7.78455 15.672 7.78455 15.672C5.13255 15.588 4.12455 13.848 4.12455 13.848C4.12455 9.984 5.85255 6.852 5.85255 6.852C7.58055 5.556 9.22455 5.592 9.22455 5.592L9.34455 5.736C7.18455 6.36 6.18855 7.308 6.18855 7.308C6.18855 7.308 6.45255 7.164 6.89655 6.96C8.18055 6.396 9.20055 6.24 9.62055 6.204C9.69255 6.192 9.75255 6.18 9.82455 6.18C10.5565 6.084 11.3845 6.06 12.2485 6.156C13.3885 6.288 14.6125 6.624 15.8605 7.308C15.8605 7.308 14.9125 6.408 12.8725 5.784L13.0405 5.592C13.0405 5.592 14.6845 5.556 16.4125 6.852C16.4125 6.852 18.1405 9.984 18.1405 13.848C18.1405 13.848 17.1205 15.588 14.4685 15.672Z"
                fill="#7289DA"
              />
            </svg>
          ) : (
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <g clip-path="url(#clip0_11068_48057)">
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M12 0C5.3724 0 0 5.3808 0 12.0204C0 17.3304 3.438 21.8364 8.2068 23.4252C8.8068 23.5356 9.0252 23.1648 9.0252 22.8456C9.0252 22.5612 9.0156 21.804 9.0096 20.802C5.6712 21.528 4.9668 19.1904 4.9668 19.1904C4.422 17.8008 3.6348 17.4312 3.6348 17.4312C2.5452 16.6872 3.7176 16.7016 3.7176 16.7016C4.9212 16.7856 5.5548 17.94 5.5548 17.94C6.6252 19.776 8.364 19.2456 9.0468 18.9384C9.1572 18.162 9.4668 17.6328 9.81 17.3328C7.146 17.0292 4.344 15.9972 4.344 11.3916C4.344 10.08 4.812 9.006 5.5788 8.166C5.4552 7.8624 5.0436 6.6396 5.6964 4.986C5.6964 4.986 6.7044 4.662 8.9964 6.2172C9.97532 5.95022 10.9853 5.81423 12 5.8128C13.02 5.8176 14.046 5.9508 15.0048 6.2172C17.2956 4.662 18.3012 4.9848 18.3012 4.9848C18.9564 6.6396 18.5436 7.8624 18.4212 8.166C19.1892 9.006 19.6548 10.08 19.6548 11.3916C19.6548 16.0092 16.848 17.0256 14.1756 17.3232C14.6064 17.694 14.9892 18.4272 14.9892 19.5492C14.9892 21.1548 14.9748 22.452 14.9748 22.8456C14.9748 23.1672 15.1908 23.5416 15.8004 23.424C18.19 22.6225 20.2672 21.0904 21.7386 19.0441C23.2099 16.9977 24.001 14.5408 24 12.0204C24 5.3808 18.6264 0 12 0Z"
                  fill="black"
                />
              </g>
              <defs>
                <clipPath id="clip0_11068_48057">
                  <rect width="24" height="24" fill="white" />
                </clipPath>
              </defs>
            </svg>
          )}
        </div>
        <div className="text-[#101828]">{props.name}</div>
      </div>

      <div
        className={
          "mr-3 truncate text-[#667085] " +
          (!props.displayName && !props.identity ? "opacity-50" : "")
        }
      >
        {props.displayName || props.identity || "Not Set"}
      </div>
    </div>
  );
}

interface DomainSocialRecordFromProfilesProps {
  provider: string;
  profiles: SocialProfileSimple[];
  loading: boolean;
}

export function RecordSocialDomainFromProfiles({
  provider,
  profiles,
  loading,
}: DomainSocialRecordFromProfilesProps) {
  const profile = profiles.find(
    (x: SocialProfileSimple) => x.provider == provider
  );
  const [config, setConfig] = useState<SocialConfig>();

  useEffect(() => {
    getSocialConfig(provider).then((result) => setConfig(result));
  }, []);

  if (loading || !config) {
    return (
      <div>
        <Skeleton.Input size="small" active={true} />
      </div>
    );
  }

  return (
    <RecordSocialDomain
      {...config}
      provider={provider}
      identity={profile?.identity}
      displayName={profile?.displayName}
    />
  );
}
